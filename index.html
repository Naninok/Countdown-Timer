<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Countdown Timer(Enhanced)</title>

<style>
  body {
    background: #0e0e0f;
    font-family: "Segoe UI", Arial, sans-serif;
    color: #fff;
    padding: 20px;
    text-align: center;
  }

  .container {
    max-width: 350px;
    margin: auto;
    background: #1a1a1d;
    padding: 20px;
    border-radius: 18px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.6);
  }

  h2 { font-weight: 500; }

  /* WHEEL */
  .wheel-box {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin: 25px 0;
  }

  .wheel {
    width: 120px;
    height: 220px;
    overflow: hidden;
    position: relative;
    border-radius: 14px;
    background: #111;
    box-shadow: 0 0 25px rgba(255,255,255,0.05) inset;
    touch-action: pan-y;
  }

  .wheel ul {
    list-style: none;
    margin: 0;
    padding: 0;
    transition: transform 0.25s ease-out;
  }

  .wheel li {
    font-size: 32px;
    padding: 14px 0;
    color: #fff;
    text-align: center;
  }

  .highlight {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 44px;
    transform: translateY(-50%);
    border-top: 2px solid #555;
    border-bottom: 2px solid #555;
    pointer-events: none;
  }

  /* buttons */
  .btn-group, .addtime {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-top: 12px;
  }

  button {
    flex: 1;
    padding: 12px;
    font-size: 15px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    transition: 0.15s;
  }

  .start { background:#28a745; }
  .stop  { background:#ffc107; color:#000; }
  .reset { background:#dc3545; }

  .add-btn { background:#444; }

  select {
    margin-top: 18px;
    padding: 10px;
    font-size: 15px;
    border-radius: 10px;
    border: none;
    background: #333;
    color: #fff;
  }
</style>
</head>

<body>

<div class="container">

  <h2>‚è≥ Dark Wheel Countdown</h2>

  <!-- Wheels -->
  <div class="wheel-box">
    <div class="wheel" id="minWheel">
      <div class="highlight"></div>
      <ul></ul>
    </div>

    <div class="wheel" id="secWheel">
      <div class="highlight"></div>
      <ul></ul>
    </div>
  </div>

  <!-- Control -->
  <div class="btn-group">
    <button id="startButton" class="start" onclick="toggle()">Start</button>
    <button class="reset" onclick="resetCountdown()">Reset</button>
  </div>

  <!-- Add time -->
  <div class="addtime">
    <button class="add-btn" onclick="addTime(60)">+1 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
    <button class="add-btn" onclick="addTime(10)">+10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</button>
  </div>

  <!-- Choose sound -->
  <div style="margin-top:18px;">
    <label>üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</label><br>
    <select id="soundSelect">
      <option value="alarm1">‚è∞ Alarm 1</option>
      <option value="alarm2">üö® Alarm 2</option>
      <option value="alarm3">üîî Bell</option>
    </select>
  </div>

  <audio id="alarm1" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
  <audio id="alarm2" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
  <audio id="alarm3" src="https://actions.google.com/sounds/v1/bells/dry_bell.ogg"></audio>

</div>

<script>
/* Create wheel with infinite looping */
function createWheel(wheelEl) {
  const ul = wheelEl.querySelector("ul");
  for (let i=-2; i<=61; i++) {
    let n = (i+60) % 60;
    const li = document.createElement("li");
    li.textContent = String(n).padStart(2,"0");
    li.dataset.value = n;
    ul.appendChild(li);
  }
  wheelEl.ul = ul;
  wheelEl.offset = -2;
  wheelEl.value = 0;

  /* Auto snap center on release */
  let startY = 0;
  let lastY = 0;

  wheelEl.addEventListener("touchstart", e=>{
    wheelEl.ul.style.transition = "none";
    startY = lastY = e.touches[0].clientY;
  });

  wheelEl.addEventListener("touchmove", e=>{
    const y = e.touches[0].clientY;
    const delta = y - lastY;
    lastY = y;

    const current = getTranslateY(wheelEl.ul);
    wheelEl.ul.style.transform = `translateY(${current + delta}px)`;
  });

  wheelEl.addEventListener("touchend", ()=>{
    wheelEl.ul.style.transition = "transform 0.25s ease-out";
    snapToNearest(wheelEl);
  });
}

function getTranslateY(el){
  const st = window.getComputedStyle(el).transform;
  if (st === "none") return 0;
  const matrix = new DOMMatrix(st);
  return matrix.m42;
}

function snapToNearest(wheel){
  const pos = getTranslateY(wheel.ul);
  let index = Math.round(-pos / 44);
  if (index < 0) index = 0;
  if (index > 62) index = 62;

  wheel.value = (index + wheel.offset + 60) % 60;
  const newPos = -index * 44;
  wheel.ul.style.transform = `translateY(${newPos}px)`;
}

/* Initialization */
const minWheel = document.getElementById("minWheel");
const secWheel = document.getElementById("secWheel");
createWheel(minWheel);
createWheel(secWheel);

function scrollToValue(wheel, val){
  wheel.value = val;
  const index = (val - wheel.offset + 60) % 60;
  wheel.ul.style.transition = "transform 0.25s ease-out";
  wheel.ul.style.transform = `translateY(${-index * 44}px)`;
}

scrollToValue(minWheel, 0);
scrollToValue(secWheel, 0);

/* Countdown logic */
let cdRemaining = 0;
let timer = null;
let running = false;

function playSound(){
  const id = document.getElementById("soundSelect").value;
  document.getElementById(id).play();

  // Vibrate mobile
  if (navigator.vibrate) navigator.vibrate([300,150,300]);
}

function start(){
  if (timer) return;

  timer = setInterval(()=>{
    cdRemaining -= 1000;

    if (cdRemaining <= 0){
      cdRemaining = 0;
      scrollToValue(minWheel, 0);
      scrollToValue(secWheel, 0);

      stop();
      playSound();
      alert("‚è∞ Time's up!");
      return;
    }

    const m = Math.floor(cdRemaining/60000);
    const s = Math.floor((cdRemaining%60000)/1000);

    scrollToValue(minWheel, m);
    scrollToValue(secWheel, s);
  }, 1000);

  running = true;
  const b = document.getElementById("startButton");
  b.textContent = "Stop";
  b.classList.remove("start");
  b.classList.add("stop");
}

function stop(){
  clearInterval(timer);
  timer = null;
  running = false;

  const b = document.getElementById("startButton");
  b.textContent = "Start";
  b.classList.remove("stop");
  b.classList.add("start");
}

function toggle(){
  if (running) stop();
  else {
    if (cdRemaining <= 0){
      cdRemaining = (minWheel.value*60 + secWheel.value)*1000;
    }
    if (cdRemaining > 0) start();
  }
}

function resetCountdown(){
  stop();
  cdRemaining = 0;
  scrollToValue(minWheel, 0);
  scrollToValue(secWheel, 0);
}

/* Add time buttons */
function addTime(sec){
  cdRemaining += sec * 1000;

  let m = Math.floor(cdRemaining/60000);
  let s = Math.floor((cdRemaining%60000)/1000);

  scrollToValue(minWheel, m%60);
  scrollToValue(secWheel, s%60);
}
</script>

</body>
</html>


